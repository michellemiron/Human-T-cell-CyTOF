<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Michelle Miron" />

<meta name="date" content="2017-10-10" />

<title>Heatmap</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Human-T-cell-CyTOF</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/michellemiron">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Heatmap</h1>
<h4 class="author"><em>Michelle Miron</em></h4>
<h4 class="date"><em>10/10/2017</em></h4>

</div>


<p><strong>Last updated:</strong> 2018-10-12</p>
<strong>workflowr checks:</strong> <small>(Click a bullet for more information)</small>
<ul>
<li>
<details>
<p><summary> <strong style="color:red;">✖</strong> <strong>R Markdown file:</strong> uncommitted changes </summary> The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Environment:</strong> empty </summary></p>
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Seed:</strong> <code>set.seed(20181011)</code> </summary></p>
<p>The command <code>set.seed(20181011)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Session information:</strong> recorded </summary></p>
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Repository version:</strong> <a href="https://github.com/michellemiron/Human-T-cell-CyTOF/tree/cfc868acb60ac4a14c344d0cc8a58dd423b45873" target="_blank">cfc868a</a> </summary></p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rapp.history
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.Rhistory
    Ignored:    docs/.DS_Store

Unstaged changes:
    Modified:   analysis/Heatmap.Rmd

</code></pre>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</details>
</li>
</ul>
<details>
<summary> <small><strong>Expand here to see past versions:</strong></small> </summary>
<ul>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/michellemiron/Human-T-cell-CyTOF/cfc868acb60ac4a14c344d0cc8a58dd423b45873/docs/Heatmap.html" target="_blank">cfc868a</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-12
</td>
<td style="text-align:left;">
update heatmap html
</td>
</tr>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/ee696c6cd5971307328376cf901bf8f8738daa33/analysis/Heatmap.Rmd" target="_blank">ee696c6</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-12
</td>
<td style="text-align:left;">
minor edit
</td>
</tr>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/michellemiron/Human-T-cell-CyTOF/ac2d94cff2eaaf697d32bc188e79be6a0381eab6/docs/Heatmap.html" target="_blank">ac2d94c</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-12
</td>
<td style="text-align:left;">
publish htmls
</td>
</tr>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/18fb477d7384b118fa86a01dad8b6040adc285e9/analysis/Heatmap.Rmd" target="_blank">18fb477</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-12
</td>
<td style="text-align:left;">
clean up heatmap code
</td>
</tr>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/michellemiron/Human-T-cell-CyTOF/6cc5c2b1ba6c575939bdd07e2e19a5de9a1a924f/docs/Heatmap.html" target="_blank">6cc5c2b</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-11
</td>
<td style="text-align:left;">
docs added
</td>
</tr>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/0f8b39444b920524af3050463f4fcf844c5a50fb/analysis/Heatmap.Rmd" target="_blank">0f8b394</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-11
</td>
<td style="text-align:left;">
adding files
</td>
</tr>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/d55507913acac02a76568ba1e30117fc3e373b60/analysis/Heatmap.Rmd" target="_blank">d555079</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-11
</td>
<td style="text-align:left;">
heatmap analysis
</td>
</tr>
</tbody>
</table>
</ul>
</details>
<hr />
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">knitr<span class="op">::</span>opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">echo =</span> <span class="ot">TRUE</span>, <span class="dt">warning =</span> <span class="ot">FALSE</span>, <span class="dt">message =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                      <span class="dt">fig.height =</span> <span class="dv">10</span>, <span class="dt">fig.width =</span> <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(gapminder)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(magrittr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(gplots)</a></code></pre></div>
<p>In this study I am comparing lymphocyte populations, specifically T cells, that have been isolated form different human tissue and organ sites. In this study the lymphocyte populations I am comparing have been isolated from the following sites: Blood, Bone marrow (BM), Spleen ( Spl), Lung (Lng), and Lung-draining lymph nodes (LLN). Each tissue site was collected from a single individual, and data from multiple individuals will be analyzed here. ###Code book ####Fixed variables</p>
<p>These are variables that do not change because you know them in advance of the experiment, before collecting any data.</p>
<ol style="list-style-type: decimal">
<li><p>Tissue,with four possible values (BM, Spl, LLN, and Lung)</p>
<pre><code>                          Tissue       | Abbreviation 
                         ------------- | ------------- 
                         Bone Marrow   | BM       
                         Spleen        | Spl
                         Lung          | Lng
                         Lymph node    | LN</code></pre></li>
<li><p>Individual, with three possible values(332,333, 335)</p>
<pre><code>                         Individual    | ID # 
                         ------------- | -------
                         1             | 332       
                         2             | 333
                         3             | 335</code></pre></li>
<li><p>T cell subset, with two valuees (MEM, or Naive)</p>
<pre><code>                         Subset          | Abbreviation
                         --------------- | -------------
                         Naive T cell    | Naive     
                         Memory T cell   | TEM</code></pre>
<p>###Raw data</p></li>
</ol>
<p>In this case the raw data, what gets collected from the machine, needs to be read using another software. I used a paid software called <a href="http://www.denovosoftware.com/">FCS Express</a>. Here I will describe exactly what I did to export the data from this software which I call raw data.</p>
<p>Open the FCS Express software. On the top with all the menu options, click Export. This will open a window which you can need to choose and do the following: 1) name the file you are exporting 2) choose the parameters you want to export ( I exported all and edited the ones i wanted once it was loaded into R) 3) Choose the number of cells you want to export ( I exported 1 million, knowing that was an over-estimate to get all the cells) 4) Choose the “gate” you want to export. These are gates that you have defined in the program that identify the cell populations you are interested. Ie. for my cell types, protein expression of CCR7 and CD45RA identifies TEM and Naive T cells as CCR7-CD45RA- and CCR7+CD45RA+ respectively.</p>
<p>###Steps to get the raw data</p>
<ol style="list-style-type: decimal">
<li><p>Step 1 - take the raw file, run version FCS express (version 6), and do the following steps within the FCS express program.</p></li>
<li><p>Step 2 - Concatenate the files using the FCS express data exporting option and make sure to label the file that you are exporting according to the files being merged.</p></li>
<li><p>Step 3 - Open the concatenated file and gate on populations of interest.</p></li>
<li><p>Step 4 - Export the data on any one given subset using the data export function from FCSexpress, containing expresion level on each individual cell. One file was exported for each cell subset.</p></li>
</ol>
<div id="load-data" class="section level3">
<h3>Load data</h3>
<p>This is what the Raw data looks like:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">          Raw_BM_TEM &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/BM_TEM_D332_333_335_exp2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">          <span class="co">#colnames(Raw_BM_TEM)</span></a></code></pre></div>
<p>The problem is there is a separate file for each Tissue site (a variable) :</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">  Raw_BM_TEM &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/BM_TEM_D332_333_335_exp2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  Raw_Spl_TEM &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/SPL_TEM_D332_333_335_exp2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  Raw_LN_TEM &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/LLN_TEM_D332_333_335_exp2.csv&quot;</span>) </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  Raw_Lng_TEM &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Lung_TEM_D332_333_335_exp2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  Raw_LN_Naive &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/LLN_Naive_D332_333_335_exp2.csv&quot;</span>)</a></code></pre></div>
<p>In order to fix this, the next step is to merge the data from each file, which cnotained data on all the cells within on subset (Naive or Memory T cells from a particular tissue), into a database/file with all the data from each cell subset from different tissues together. I call the merged data “tidy” data below.</p>
</div>
<div id="tidy-data-and-messy-data" class="section level3">
<h3>Tidy data and Messy data</h3>
<p>Tidy <a href="http://vita.had.co.nz/papers/tidy-data.html">data</a> is a uniform way to make data more organized and easier to do statsitics and analysis on. Here I will put the data into the tidy format. This consists of three steps:</p>
<p>1.Only Keep relevant columns in data set:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># A function to keep a subset of columns in the dataframe</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co"># and to fix an aritifact in the File.Identifier column</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">tidyDataColumns &lt;-<span class="st"> </span><span class="cf">function</span>(RawData) {</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">          </a>
<a class="sourceLine" id="cb7-5" data-line-number="5">          <span class="co"># Name columns to keep</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">          keeps &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;CD57&quot;</span>,<span class="st">&quot;CD28&quot;</span>,<span class="st">&quot;CD45RA&quot;</span>,<span class="st">&quot;CD103&quot;</span>,<span class="st">&quot;Perforin&quot;</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                                         <span class="st">&quot;CD127&quot;</span>,<span class="st">&quot;PD_1&quot;</span>,<span class="st">&quot;ICOS&quot;</span>,<span class="st">&quot;CD27&quot;</span>,<span class="st">&quot;CCR5&quot;</span>,<span class="st">&quot;Bcl6&quot;</span>,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">                                         <span class="st">&quot;Tcf1&quot;</span>,<span class="st">&quot;CD14&quot;</span>,<span class="st">&quot;CD56&quot;</span>,<span class="st">&quot;CXCR5&quot;</span>,<span class="st">&quot;CD69&quot;</span>,<span class="st">&quot;X41BB&quot;</span>,<span class="st">&quot;CD25&quot;</span>,</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">                                         <span class="st">&quot;CCR7&quot;</span>,<span class="st">&quot;CD3&quot;</span>,<span class="st">&quot;Tbet&quot;</span>,<span class="st">&quot;CD38&quot;</span>,<span class="st">&quot;CD95&quot;</span>,<span class="st">&quot;LAG3&quot;</span>,</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">                                         <span class="st">&quot;CXCR4&quot;</span>,<span class="st">&quot;HLADR&quot;</span>, <span class="st">&quot;TIGIT&quot;</span>,<span class="st">&quot;GranzymeB&quot;</span>,</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">                                         <span class="st">&quot;File.Identifier&quot;</span>)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">        </a>
<a class="sourceLine" id="cb7-13" data-line-number="13">          <span class="co"># The subset of the raw data that contains columns defined above</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">          KeyMarkersdf &lt;-<span class="st"> </span>RawData[keeps]</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">                    </a>
<a class="sourceLine" id="cb7-16" data-line-number="16">          <span class="co"># There is an artifact of the data</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">          <span class="co"># The &quot;File.Identifier&quot; column was generated from the FCSexpress program</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">          <span class="co"># This column is a number 1-12 that is a unique identifier </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19">          <span class="co"># The unique identifier tells you what sample the cells are from</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">          <span class="co"># For example, 1 = Bome marrrow from D332, 2= BM from D333</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21">          <span class="co"># The key to this identifier is in step 2 of tidy data below</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22">          <span class="co"># The artifact is that the he program outputs the File.Identifier number </span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23">          <span class="co"># as a real number ie. (1.04243) instead of an integer ie. (1)</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24">          <span class="co"># Therefore I rounded the File.Identifier column here:</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25">          File.ID.Rounded &lt;-<span class="st"> </span><span class="kw">round</span>(KeyMarkersdf<span class="op">$</span>File.Identifier, <span class="dt">digits=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb7-26" data-line-number="26">          <span class="co"># Take away the non-rounded file identifier</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27">          NoFileIDdf &lt;-<span class="st"> </span><span class="kw">subset</span>(KeyMarkersdf, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(File.Identifier) )</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">          <span class="co"># Add_Rounded_FileID to the dataframe</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29">          NoFileIDdf<span class="op">$</span>File.ID &lt;-<span class="st"> </span>File.ID.Rounded</a>
<a class="sourceLine" id="cb7-30" data-line-number="30">          <span class="co"># Rename the dataset</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31">          Tidydf &lt;-<span class="st"> </span>NoFileIDdf</a>
<a class="sourceLine" id="cb7-32" data-line-number="32">}</a>
<a class="sourceLine" id="cb7-33" data-line-number="33"></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co"># Apply this function to all data sets</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35">          Tidy_BM_TEM &lt;-<span class="st"> </span><span class="kw">tidyDataColumns</span>(Raw_BM_TEM)</a>
<a class="sourceLine" id="cb7-36" data-line-number="36">          Tidy_LN_TEM &lt;-<span class="st"> </span><span class="kw">tidyDataColumns</span>(Raw_LN_TEM)</a>
<a class="sourceLine" id="cb7-37" data-line-number="37">          Tidy_Spl_TEM &lt;-<span class="st"> </span><span class="kw">tidyDataColumns</span>(Raw_Spl_TEM)</a>
<a class="sourceLine" id="cb7-38" data-line-number="38">          Tidy_Lung_TEM &lt;-<span class="st"> </span><span class="kw">tidyDataColumns</span>(Raw_Lng_TEM)</a>
<a class="sourceLine" id="cb7-39" data-line-number="39">          Tidy_LN_Naive &lt;-<span class="st"> </span><span class="kw">tidyDataColumns</span>(Raw_LN_Naive)</a></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Combined the data sets together into one table:</li>
</ol>
<p>Remember that for this data set, the tissue varibale can still be disintuigshed by the file ID column. However the subset Variable cannot, So i will add this variable to each data set:</p>
<p>Add a column that says subset name as a new variable:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">Tidy_BM_TEM[<span class="st">&quot;Subset&quot;</span>] &lt;-<span class="st"> &quot;TEM&quot;</span> </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">Tidy_LN_Naive[<span class="st">&quot;Subset&quot;</span>] &lt;-<span class="st"> &quot;Naive&quot;</span> </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">Tidy_LN_TEM[<span class="st">&quot;Subset&quot;</span>] &lt;-<span class="st"> &quot;TEM&quot;</span> </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">Tidy_Lung_TEM[<span class="st">&quot;Subset&quot;</span>] &lt;-<span class="st"> &quot;TEM&quot;</span> </a>
<a class="sourceLine" id="cb8-5" data-line-number="5">Tidy_Spl_TEM[<span class="st">&quot;Subset&quot;</span>] &lt;-<span class="st"> &quot;TEM&quot;</span> </a></code></pre></div>
<p>And now combine each data set by adding new rows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">TidyMasterData &lt;-<span class="st"> </span><span class="kw">do.call</span>( <span class="st">&quot;rbind&quot;</span>, <span class="kw">list</span>(Tidy_BM_TEM, </a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                                         Tidy_LN_Naive,Tidy_LN_TEM, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">                                         Tidy_Spl_TEM, Tidy_Lung_TEM))</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Add variables that are imbedded in “File.Identifier” column</li>
</ol>
<p>The “File.Identifier” column has a key which reveals what variables they represent:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#add tissue and donor column</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">TidyMasterData[<span class="st">&quot;Tissue&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">TidyMasterData[<span class="st">&quot;Donor&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                              </a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#Here is the key for what the File.ID column is</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8">File.Identifier_Key &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/File Identifier key.csv&quot;</span>)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">File.Identifier_Key</a></code></pre></div>
<pre><code>   File.Identifier Tissue Donor
1                1    BM    332
2                2    BM    333
3                3    BM    335
4                4    LN    332
5                5    LN    333
6                6    LN    335
7                7   Spl    332
8                8   Spl    333
9                9   Spl    335
10              10   Lung   332
11              11  Lung    333
12              12  Lung    335</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co">#Use the File.Identifier Key to label the table for the correct variables</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#associated with the observations</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(File.Identifier_Key[,<span class="dv">1</span>])) {</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">          TidyMasterData<span class="op">$</span>Tissue[TidyMasterData<span class="op">$</span>File.ID<span class="op">==</span>i] &lt;-<span class="st"> </span><span class="kw">as.character</span>(</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">                    File.Identifier_Key<span class="op">$</span>Tissue[i])</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">          TidyMasterData<span class="op">$</span>Donor[TidyMasterData<span class="op">$</span>File.ID<span class="op">==</span>i] &lt;-<span class="st"> </span>File.Identifier_Key<span class="op">$</span>Donor[i]      </a>
<a class="sourceLine" id="cb12-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#sample_n(TidyMasterData, 10)</span></a></code></pre></div>
<p>Now to fix order of the columns so that the fixed variables ( File.ID, Subset, Tissue, and Donor) are first, and the oberserved variables (Protein names like CD57, T-bet , etc. are next). Here we will also remove the Time and File.ID column since those are no longer needed.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#Remove columns that are not needed by their number in the dataframe</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">TidyData &lt;-<span class="st"> </span>TidyMasterData[,<span class="kw">c</span>(<span class="dv">33</span>,<span class="dv">32</span>,<span class="dv">31</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">29</span>)]</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#sample_n(TidyData, 10)</span></a></code></pre></div>
<p>Time to make the last changes to make tidy data. Let’s add a column to be a unique identifier for each cell number</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">TidyData[<span class="st">&quot;Cell&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(TidyData)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">TidyDatabyCell&lt;-<span class="st"> </span>TidyData[,<span class="kw">c</span>(<span class="dv">32</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">31</span>)]</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">messy &lt;-<span class="st"> </span>TidyDatabyCell</a></code></pre></div>
<p>This will turn all the marker variables into rows instead of columns</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">tidy &lt;-<span class="st"> </span>messy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw">gather</span>(Marker, Expression, CD57<span class="op">:</span>GranzymeB)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#sample_n(tidy,10)</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#sample_n(messy,10)</span></a></code></pre></div>
<p>Now we can plot this easily using ggplot. This is if you want to plot values of individual cells:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> tidy, <span class="kw">aes</span>(<span class="dt">x =</span> Cell, <span class="dt">y =</span> Marker)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Expression)) </a></code></pre></div>
<p><img src="figure/Heatmap.Rmd/unnamed-chunk-10-1.png" width="1344" style="display: block; margin: auto;" /></p>
<details>
<summary><em>Expand here to see past versions of unnamed-chunk-10-1.png:</em></summary>
<table style = "border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/6cc5c2b1ba6c575939bdd07e2e19a5de9a1a924f/docs/figure/Heatmap.Rmd/unnamed-chunk-10-1.png" target="_blank">6cc5c2b</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-11
</td>
</tr>
</tbody>
</table>
</details>
</div>
<div id="mean-of-the-data" class="section level3">
<h3>Mean of the data</h3>
<p>#used this tutorial: <a href="http://stat545.com/block023_dplyr-do.html" class="uri">http://stat545.com/block023_dplyr-do.html</a></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co">#this function allows multiple pipes to use with dplyr</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2"></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">meanDB &lt;-<span class="st"> </span>tidy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="st">           </span><span class="kw">group_by</span>(Donor,Tissue, Subset, Marker) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="st">                    </span><span class="kw">summarize</span>(<span class="dt">meanExpression =</span> <span class="kw">mean</span>(Expression))</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">                    </a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#and Z score of this data</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8">ZscoreDB &lt;-<span class="st"> </span>meanDB <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(Donor,Marker) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z_score =</span> <span class="kw">scale</span>(meanExpression))  </a>
<a class="sourceLine" id="cb17-11" data-line-number="11"> </a>
<a class="sourceLine" id="cb17-12" data-line-number="12">ZscoreDB &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(ZscoreDB)</a>
<a class="sourceLine" id="cb17-13" data-line-number="13">  meanZscoredf &lt;-<span class="st"> </span>ZscoreDB</a></code></pre></div>
<p>#create unique name for each sample type</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">MeanZscore_SampleIDdf &lt;-<span class="st"> </span>meanZscoredf</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">MeanZscore_SampleIDdf<span class="op">$</span>Sample &lt;-<span class="st"> </span><span class="kw">paste</span>(MeanZscore_SampleIDdf<span class="op">$</span>Donor,MeanZscore_SampleIDdf<span class="op">$</span>Tissue,MeanZscore_SampleIDdf<span class="op">$</span>Subset)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="co">#sample_n(MeanZscore_SampleIDdf,10)</span></a></code></pre></div>
</div>
<div id="plot-z-score-mean-data" class="section level3">
<h3>plot Z score mean data</h3>
<p>Lets first get the data “untidy” so it’s easier to use heatmap.2</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">Zscoredf &lt;-<span class="st"> </span>MeanZscore_SampleIDdf[,<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>)] </a>
<a class="sourceLine" id="cb19-2" data-line-number="2">ZscoreforHeatmap &lt;-<span class="st"> </span><span class="kw">spread</span>(Zscoredf, Marker, z_score)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">ZscoreforHeatmap_justValues &lt;-<span class="st"> </span>ZscoreforHeatmap[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>)]</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#name rows of the df for heatmap plotting so labels showup</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="kw">rownames</span>(ZscoreforHeatmap_justValues) &lt;-<span class="st"> </span>ZscoreforHeatmap[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#graph heatmap</span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#going to try following this [heatmap #tutorial](http://varianceexplained.org/r/love-actually-network/)</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#color cheat sheet https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/colorPaletteCheatsheet.pdf</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="kw">colnames</span>(ZscoreforHeatmap_justValues)</a></code></pre></div>
<pre><code> [1] &quot;Bcl6&quot;      &quot;CCR5&quot;      &quot;CCR7&quot;      &quot;CD103&quot;     &quot;CD127&quot;    
 [6] &quot;CD14&quot;      &quot;CD25&quot;      &quot;CD27&quot;      &quot;CD28&quot;      &quot;CD3&quot;      
[11] &quot;CD38&quot;      &quot;CD45RA&quot;    &quot;CD56&quot;      &quot;CD57&quot;      &quot;CD69&quot;     
[16] &quot;CD95&quot;      &quot;CXCR4&quot;     &quot;CXCR5&quot;     &quot;GranzymeB&quot; &quot;HLADR&quot;    
[21] &quot;ICOS&quot;      &quot;LAG3&quot;      &quot;PD_1&quot;      &quot;Perforin&quot;  &quot;Tbet&quot;     
[26] &quot;Tcf1&quot;      &quot;TIGIT&quot;     &quot;X41BB&quot;    </code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">SelectZscores &lt;-ZscoreforHeatmap_justValues[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">28</span>)]</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">my_palette &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;steelblue3&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;sienna3&quot;</span>))(<span class="dt">n =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">heatmap.2</span>(<span class="kw">as.matrix</span>(<span class="kw">t</span>(SelectZscores)),<span class="dt">trace=</span><span class="st">&quot;none&quot;</span>,<span class="dt">col=</span>my_palette,<span class="dt">cexRow=</span><span class="fl">0.75</span>, <span class="dt">cexCol=</span><span class="fl">0.5</span>, <span class="dt">breaks=</span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.02</span>)))</a></code></pre></div>
<p><img src="figure/Heatmap.Rmd/unnamed-chunk-13-1.png" width="1344" style="display: block; margin: auto;" /></p>
<details>
<summary><em>Expand here to see past versions of unnamed-chunk-13-1.png:</em></summary>
<table style = "border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/ac2d94cff2eaaf697d32bc188e79be6a0381eab6/docs/figure/Heatmap.Rmd/unnamed-chunk-13-1.png" target="_blank">ac2d94c</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-12
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="https://github.com/michellemiron/Human-T-cell-CyTOF/blob/6cc5c2b1ba6c575939bdd07e2e19a5de9a1a924f/docs/figure/Heatmap.Rmd/unnamed-chunk-13-1.png" target="_blank">6cc5c2b</a>
</td>
<td style="text-align:left;">
michellemiron
</td>
<td style="text-align:left;">
2018-10-11
</td>
</tr>
</tbody>
</table>
</details>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>R version 3.4.4 (2018-03-15)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS Sierra 10.12.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] bindrcpp_0.2.2  gplots_3.0.1    magrittr_1.5    gapminder_0.3.0
[5] ggplot2_3.0.0   tidyr_0.8.0     dplyr_0.7.4    

loaded via a namespace (and not attached):
 [1] Rcpp_0.12.16       compiler_3.4.4     pillar_1.2.2      
 [4] git2r_0.21.0       plyr_1.8.4         workflowr_1.1.1   
 [7] bindr_0.1.1        bitops_1.0-6       R.methodsS3_1.7.1 
[10] R.utils_2.6.0      tools_3.4.4        digest_0.6.15     
[13] evaluate_0.10.1    tibble_1.4.2       gtable_0.2.0      
[16] pkgconfig_2.0.1    rlang_0.2.0        yaml_2.1.19       
[19] withr_2.1.2        stringr_1.3.0      knitr_1.20        
[22] caTools_1.17.1     gtools_3.5.0       tidyselect_0.2.4  
[25] rprojroot_1.3-2    grid_3.4.4         glue_1.2.0        
[28] R6_2.2.2           rmarkdown_1.9      gdata_2.18.0      
[31] purrr_0.2.4        whisker_0.3-2      backports_1.1.2   
[34] scales_1.0.0       htmltools_0.3.6    assertthat_0.2.0  
[37] colorspace_1.3-2   labeling_0.3       KernSmooth_2.23-15
[40] stringi_1.2.2      lazyeval_0.2.1     munsell_0.5.0     
[43] R.oo_1.22.0       </code></pre>
</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<hr>
<p>
  This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a>
  analysis was created with
  <a href="https://github.com/jdblischak/workflowr">workflowr</a> 1.1.1
</p>
<hr>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
